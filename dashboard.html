<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GrowFi Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="dashboard-container">
        <header class="dashboard-header">
            <div class="header-left">
                <h1>Welcome, <span id="dashUsername"></span>!</h1>
            </div>
            <button class="btn btn-secondary" onclick="logoutUser()">Logout</button>
        </header>

        <!-- Profile Section (FEATURE 4) -->
        <section class="profile-section">
            <div class="profile-card">
                <div class="profile-avatar">
                    <span id="userAvatar" class="avatar-display">üí∞</span>
                </div>
                <div class="profile-info">
                    <h2 id="dashUsername2"></h2>
                    <p class="profile-title" id="profileTitle">Financial Beginner</p>
                    <p class="profile-meta">
                        üéØ Knowledge Level: <span id="profileKnowledge"></span>
                    </p>
                </div>
            </div>

            <!-- Streak Display (FEATURE 3) -->
            <div class="streak-card">
                <div class="streak-icon">üî•</div>
                <div class="streak-info">
                    <p class="streak-label">Login Streak</p>
                    <p class="streak-number" id="streakNumber">1</p>
                    <p class="streak-message" id="streakMessage">Keep it up!</p>
                </div>
            </div>
        </section>

        <!-- Progress Bar Section (FEATURE 1) -->
        <section class="progress-section">
            <h2>Overall Progress</h2>
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <p class="progress-text" id="progressText">0% Complete</p>
            </div>
            <p class="progress-message" id="progressMessage"></p>
        </section>

        <section class="dashboard-stats">
            <div class="stat-card">
                <label>Points:</label>
                <span id="dashPoints">0</span>
            </div>
            <div class="stat-card">
                <label>Badges:</label>
                <span id="dashBadges">None</span>
            </div>
            <div class="stat-card">
                <label>Wallet Balance:</label>
                <span id="dashWallet">‚Çπ0</span>
            </div>
        </section>

        <section class="dashboard-progress">
            <h2>Module Progress</h2>
            <ul class="progress-list">
                <li>
                    <a href="budgeting.html" class="module-link">üìä Budgeting Basics</a>
                    <span id="modBudgeting" class="status">‚¨ú</span>
                </li>
                <li>
                    <a href="saving.html" class="module-link">üè¶ Saving Strategies</a>
                    <span id="modSaving" class="status">‚¨ú</span>
                </li>
                <li>
                    <a href="invest.html" class="module-link">üìà Invest Smart</a>
                    <span id="modInvest" class="status">‚¨ú</span>
                </li>
                <li>
                    <a href="expense.html" class="module-link">üí∞ Expense Tracking</a>
                    <span id="modExpense" class="status">‚¨ú</span>
                </li>
            </ul>
        </section>

        <section class="dashboard-ai">
            <h2>ü§ñ AI Recommendation</h2>
            <div id="aiRecommendation" class="ai-box"></div>
        </section>
    </div>

    <script src="script.js"></script>
    <script>
        // Dashboard page logic
        function loadDashboard() {
            const userStr = localStorage.getItem('currentUser');
            if (!userStr) {
                window.location.href = 'index.html';
                return;
            }
            
            const user = JSON.parse(userStr);

            // Update login streak (FEATURE 3)
            updateLoginStreak(user);

            // Display user info
            document.getElementById('dashUsername').textContent = user.username;
            document.getElementById('dashUsername2').textContent = user.username;
            document.getElementById('userAvatar').textContent = user.avatar || 'üí∞';
            document.getElementById('dashPoints').textContent = user.points;
            document.getElementById('dashWallet').textContent = '‚Çπ' + user.walletBalance;
            document.getElementById('profileKnowledge').textContent = user.knowledgeLevel || 'Basic';

            // Display profile title based on points (FEATURE 4)
            const profileTitle = getProfileTitle(user.points);
            document.getElementById('profileTitle').textContent = profileTitle;

            // Badges display
            document.getElementById('dashBadges').textContent = 
                user.badges.length === 0 ? 'None' : user.badges.join(', ');

            // Module completion status
            document.getElementById('modBudgeting').textContent = user.completedModules.budgeting ? '‚úÖ' : '‚¨ú';
            document.getElementById('modSaving').textContent = user.completedModules.saving ? '‚úÖ' : '‚¨ú';
            document.getElementById('modInvest').textContent = user.completedModules.invest ? '‚úÖ' : '‚¨ú';
            document.getElementById('modExpense').textContent = user.completedModules.expense ? '‚úÖ' : '‚¨ú';

            // Update progress bar (FEATURE 1)
            updateProgressBar(user);

            // Display streak (FEATURE 3)
            document.getElementById('streakNumber').textContent = user.currentStreak || 1;
            const streakMessage = getStreakMessage(user.currentStreak || 1);
            document.getElementById('streakMessage').textContent = streakMessage;

            // Rule-based AI Recommendation
            let aiText = "";
            if (user.points < 100) {
                aiText = "üí° We recommend you start with <strong>Budgeting Basics</strong>! Master the fundamentals first.";
            } else {
                aiText = "üöÄ Great progress! Try <strong>Invest Smart</strong> for advanced learning.";
            }
            document.getElementById('aiRecommendation').innerHTML = aiText;
        }

        function logoutUser() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // Load dashboard on page load
        loadDashboard();
    </script>
</body>
</html>